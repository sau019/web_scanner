import socket
service_ports = {
    0: "RESERVED",
    1: "TCPMUX",
    5: "RJE",
    7: "ECHO",
    9: "DISCARD",
    11: "SYSTAT",
    13: "DAYTIME",
    17: "QOTD",
    18: "MSP",
    19: "CHARGEN",
    20: "FTP-DATA",
    21: "FTP",
    22: "SSH",
    23: "TELNET",
    25: "SMTP",
    37: "TIME",
    39: "RLP",
    42: "NAMESERVER",
    43: "WHOIS",
    49: "TACACS",
    50: "RE-MAIL-CK",
    53: "DNS",
    57: "MTP",
    65: "TACACS-DS",
    67: "DHCP-SERVER",
    68: "DHCP-CLIENT",
    69: "TFTP",
    70: "GOPHER",
    71: "NETRJS-1",
    72: "NETRJS-2",
    73: "NETRJS-3",
    74: "NETRJS-4",
    79: "FINGER",
    80: "HTTP",
    81: "HOSTS2-NS",
    88: "KERBEROS",
    90: "DNSIX",
    92: "NPP",
    95: "SUPDUP",
    98: "LINUXCONF",
    101: "HOSTNAME",
    102: "ISO-TSAP",
    104: "ACR-NEMA",
    105: "CSNET-NS",
    106: "POP3PW",
    107: "RTELNET",
    109: "POP2",
    110: "POP3",
    111: "RPCBIND",
    113: "IDENT",
    115: "SFTP",
    117: "UUCP-PATH",
    119: "NNTP",
    123: "NTP",
    129: "PWDGEN",
    135: "MS-RPC",
    137: "NETBIOS-NS",
    138: "NETBIOS-DGM",
    139: "NETBIOS-SSN",
    143: "IMAP",
    152: "BFTP",
    156: "SQLSRV",
    161: "SNMP",
    162: "SNMPTRAP",
    170: "PRINT-SRV",
    179: "BGP",
    194: "IRC",
    199: "SMUX",
    201: "APPLE-TALK",
    209: "QMTP",
    213: "IPX",
    218: "MPP",
    220: "IMAP3",
    259: "ESRO-GW",
    264: "BGMP",
    308: "NOVASTORBAKUP",
    311: "ASIP-WEBADMIN",
    318: "PKIX-TIMESTAMP",
    319: "PTP-EVENT",
    320: "PTP-GENERAL",
    350: "MATIP-TYPE-A",
    351: "MATIP-TYPE-B",
    366: "ODMR",
    369: "RPC2PORTMAP",
    370: "CODA-AUTH2",
    371: "CLEARCASE",
    389: "LDAP",
    399: "DECNET-PLUS",
    427: "SLP",
    434: "MOBILE-IP-AGENT",
    443: "HTTPS",
    444: "SNPP",
    445: "SMB/CIFS",
    458: "APPLE-QUICKTIME",
    464: "KERBEROS-CHG-PWD",
    465: "SMTPS",
    475: "TCPNETHASPSRV",
    497: "RETROSPECT",
    500: "ISAKMP",
    512: "EXEC",
    513: "LOGIN",
    514: "SHELL/SYSLOG",
    515: "LPD",
    517: "TALK",
    518: "NTALK",
    520: "RIP",
    524: "NCP",
    525: "TIMED",
    530: "RPC",
    532: "NETNEWS",
    533: "NETWALL",
    543: "KLOGIN",
    544: "KSHELL",
    548: "AFP",
    554: "RTSP",
    556: "REMOTEFS",
    563: "NNTPS",
    587: "SMTP-SUBMISSION",
    593: "RPC-OVER-HTTP",
    601: "SYSLOG-UDP",
    604: "TUNNEL",
    631: "IPP",
    636: "LDAPS",
    646: "LDP",
    666: "DOOM-LEGACY",
    674: "ACAP",
    694: "HA-CLUSTER",
    749: "KERBEROS-ADM",
    750: "KERBEROS-IV",
    765: "WEBSTER",
    873: "RSYNC",
    901: "SWAT",
    989: "FTPS-DATA",
    990: "FTPS",
    992: "TELNETS",
    993: "IMAPS",
    995: "POP3S"

}

target = input("Enter the target IP address or hostname: ")
start_port = int(input("Enter the starting port number: "))
end_port = int(input("Enter the ending port number: "))
open_ports = []
for port in range(start_port, end_port + 1):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(1)
    result = sock.connect_ex((target, port))
    service = service_ports.get(port, "Unknown Service")
    if result == 0:
        print(f"PORT:{port}: Open ({service})")
        open_ports.append(port)
    else:   
        print(f"PORT:{port}: Closed ({service})")
    sock.close()

print("Port scanning completed.")
print("\n ---Scan Summary---")
print(f"Target: {target}")
print(f"Ports scanned: {start_port} to {end_port}") 
print("Services detected based on common port assignments.")   
print(f"ports scanned: {end_port - start_port + 1}")
print(f"Open ports: {open_ports}")
print("created by awarox")